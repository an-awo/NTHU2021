# 

- 經典導讀 Windows Internals, Part 2, 7th Edition/CHAPTER 8 System mechanisms

- Interrupts and exceptions
- trap 
- trap handler
- Trap dispatching ==> see FIGURE 8-11 

- Interrupt dispatching
- Hardware interrupt processing
- 
- interrupt dispatch table(IDT)
- Programmable interrupt controller(PIC) architecture

- 0: kd> !idt
- lkd> !pic
- lkd> !apic
- 0: kd> !ioapic  ==> 
- kd> !irql
- kd> !acpiirqarb
- kd> !arbiter 4

- Software interrupt request levels (IRQLs)
- interrupt request levels (IRQLs)
- interprocessor interrupt(IPI)
- Mapping interrupt vectors to IRQLs
- Predefined IRQLs
- Interrupt objects(KINTERRUPT)
- Line-based versus message signaled–based interrupts
- message-signaled interrupts (MSI)
- Direct Memory Access (DMA)
- Interrupt steering
- Interrupt affinity and priority
 - [HOW TO - Interrupt Affinity Policy Tool](https://www.youtube.com/watch?v=LeBp3a5WIzE)

- [Interrupt Affinity](https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/interrupt-affinity-and-priority)
  -  The affinity of an interrupt is the set of processors that can service the interrupt. 
  -  Each device has an affinity policy. 
  -  The operating system uses the affinity policy to compute the affinity for that device's interrupts. 
  -  The affinity policy can be specified in the device's INF file or registry settings.
  -  Starting with Windows Vista, administrators can use the registry to set an affinity policy for an interrupt.

- [Controller Objects](https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/introduction-to-controller-objects)
- a controller object usually represents a physical device controller with attached devices. 
- A lowest-level non-WDM driver for a set of similar devices coordinated by a physical controller can create a controller object and use it to synchronize I/O operations between the attached devices. 
- The driver implements a ControllerControl routine and calls the I/O manager's controller object support routines.


- [Kernel-Mode Driver Architecture](https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/)
